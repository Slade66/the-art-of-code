-
- ## 有什么用？
	- `docker logs` 命令用于获取容器的日志。
- ## 怎么用？
	- **语法：**`docker logs [OPTIONS] CONTAINER`
		- `OPTIONS`：
			- ((689c2c23-fcef-4b61-a261-006dc17d0a36))
		- `CONTAINER`：指定要查看日志的容器，可使用容器名称或容器 ID。
	- #### 常用选项
	  id:: 689c2c23-fcef-4b61-a261-006dc17d0a36
		- `-f` 或 `--follow`：用于实时跟踪新产生的日志。
		- `-n` 或 `--tail`：只看最后几条日志。
		- `-t` 或 `--timestamps`：为每一行从容器捕获到的日志添加时间戳前缀。
		- **根据时间范围筛选：**
			- 用于排查特定时间段内发生的问题。
			- `--since`：只显示某个时间点之后的日志。
			- `--until`：只显示某个时间点之前的日志。
- ## 底层原理
	- ### 日志驱动（Logging Drivers）
		- #### 有什么用？
			- Docker 使用日志驱动来捕获容器 `stdout`（标准输出）和 `stderr`（标准错误）流中产生的所有日志，并将这些日志路由到指定的目的地。
			- 你的应用程序只需将日志输出到控制台，剩下的事情由配置好的日志驱动接管，例如：
				- 将日志以 JSON 格式存储到宿主机的本地文件。
				- 将日志推送到集中化的日志管理平台。
			- 每个 Docker 守护进程都有一个默认的日志驱动，除非在启动容器时显式指定，否则所有容器都会使用该默认驱动。默认的日志驱动为 `json-file`。
			- 在 `docker info` 命令的输出中，`Logging Driver` 字段显示的就是当前使用的日志驱动。
		- #### 日志的传递模式
			- **阻塞模式（blocking）：**
				- 同步地将日志从容器发送至驱动，应用程序的写日志操作会阻塞，直到驱动处理完毕。
				- **性能影响**：若日志驱动（尤其是网络驱动）变慢或阻塞，可能会拖慢应用程序的性能。
			- **非阻塞模式（non-blocking）：**
				- 日志先写入内存中的环形缓冲区，再由驱动从缓冲区读取和处理。
				- **可能丢失日志**：若日志生成速度超过驱动的处理速度，当缓冲区被写满时，新日志会覆盖旧日志，导致日志数据丢失。
			- **配置方式：**
				- 可在启动容器时通过 `--log-opt` 参数设置。
				- ```bash
				  # 设置为非阻塞模式，并指定缓冲区大小为 5MB
				  docker run --log-opt mode=non-blocking --log-opt max-buffer-size=5m image-name
				  ```
		- #### 常用的日志驱动
			- **注意：**如果日志已被转发到外部系统，`docker logs` 命令将无法再查看这些日志。
			- **json-file**
				- 这是 Docker 默认的日志驱动，会将每条日志消息序列化为一个 JSON 对象，并存储在宿主机的 `/var/lib/docker/containers/<container-id>/<container-id>-json.log` 文件中。
				- **优点：**
					- **简单易用**：开箱即用，无需额外配置。
					- **`docker logs` 支持**：可以直接通过 `docker logs` 命令查看日志。
				- **缺点：**
					- **磁盘空间占用**：日志文件默认无限增长，可能迅速耗尽宿主机磁盘空间，需要手动配置日志轮转。
					- **不利于集中化管理**：日志分散在各宿主机上，在微服务或集群环境中不便于统一检索与分析。
		- #### 配置日志驱动的方式
			- **全局配置（为所有容器设置默认值）**：
				- 确保所有容器遵循统一的日志策略。
				- ```json
				  // /etc/docker/daemon.json
				  {
				    "log-driver": "json-file",
				    "log-opts": {
				      "max-size": "10m",   // 每个日志文件的最大尺寸
				      "max-file": "3"      // 最多保留的日志文件数量
				    }
				  }
				  ```
				- 注意：修改后需要重启 Docker 服务。
			- **容器级配置（为单个容器指定）**：
				- 在 `docker run` 或 `docker create` 命令中使用 `--log-driver` 和 `--log-opt` 参数。这会覆盖全局默认配置。
				- ```bash
				  docker run \
				    --log-driver=json-file \
				    --log-opt max-size=10m \
				    --log-opt max-file=3 \
				    image-name
				  ```
-