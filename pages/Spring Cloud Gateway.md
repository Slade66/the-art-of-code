æ€ä¹ˆç”¨ï¼Ÿ
heading:: true
	- **ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç‹¬ç«‹çš„ç½‘å…³é¡¹ç›®**
		- â€œé¦–å…ˆï¼Œéœ€è¦å•ç‹¬åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ Spring Boot é¡¹ç›®ï¼Œå› ä¸ºç½‘å…³æœ¬èº«å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¾®æœåŠ¡ã€‚
	- **ç¬¬äºŒæ­¥ï¼šå¼•å…¥æ ¸å¿ƒä¾èµ–**
		- åœ¨ä½ çš„ç½‘å…³é¡¹ç›®çš„ `pom.xml` æ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿å¼•å…¥ä¸¤ä¸ªæœ€æ ¸å¿ƒçš„ä¾èµ–ï¼š
			- Spring Cloud Gatewayï¼šæä¾›ç½‘å…³çš„æ ¸å¿ƒåŠŸèƒ½ã€‚
			- Nacos Discoveryï¼šè®©ä½ çš„ç½‘å…³èƒ½è¿æ¥åˆ° Nacos æ³¨å†Œä¸­å¿ƒï¼Œå¹¶æ‰¾åˆ°å…¶å®ƒå¾®æœåŠ¡ã€‚
		- ```xml
		  <dependencies>
		      <dependency>
		          <groupId>org.springframework.cloud</groupId>
		          <artifactId>spring-cloud-starter-gateway</artifactId>
		      </dependency>
		      <dependency>
		          <groupId>com.alibaba.cloud</groupId>
		          <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
		      </dependency>
		  </dependencies>
		  ```
	- **ç¬¬ä¸‰æ­¥ï¼šç¼–å†™ç½‘å…³é…ç½®ä¿¡æ¯**
		- åœ¨ç½‘å…³é¡¹ç›®çš„ `resources` ç›®å½•ä¸‹ï¼Œä¿®æ”¹ `application.yml` æ–‡ä»¶ã€‚
		- ```yaml
		  # ===================================================================
		  #                      æœåŠ¡å™¨é…ç½® (Server Configuration)
		  # ===================================================================
		  # æœåŠ¡å™¨ç«¯å£ï¼Œæˆ‘ä»¬çš„ç½‘å…³å°†è¿è¡Œåœ¨è¿™ä¸ªç«¯å£ä¸Š
		  server:
		    port: 8080 # ç½‘å…³å¯¹å¤–æš´éœ²çš„ç«¯å£
		  
		  # ===================================================================
		  #                      Spring åº”ç”¨é…ç½® (Application Configuration)
		  # ===================================================================
		  spring:
		    application:
		      name: gateway-service # ç»™ç½‘å…³æœåŠ¡è‡ªå·±èµ·ä¸ªåå­—
		  
		    # ===================================================================
		    #                      Spring Cloud é…ç½® (Cloud Configuration)
		    # ===================================================================
		    cloud:
		      # --- Nacos æœåŠ¡å‘ç°é…ç½® ---
		      nacos:
		        discovery:
		          server-addr: localhost:8848 # ä½ çš„ Nacos æœåŠ¡å™¨åœ°å€
		  
		      # ===================================================================
		      #                      ç½‘å…³æ ¸å¿ƒé…ç½® (Gateway Configuration)
		      # ===================================================================
		      gateway:
		        # --- è·¯ç”±è§„åˆ™é›†åˆ (A Collection of Route Definitions) ---
		        routes:
		          # è·¯ç”±è§„åˆ™ 1: ç”¨æˆ·æœåŠ¡
		          # -------------------------------------------------------------------
		          - id: user_route                                  # è·¯ç”±çš„å”¯ä¸€æ ‡è¯†ï¼Œè‡ªå®šä¹‰ï¼Œä¸è¦é‡å¤
		            uri: lb://userservice                           # ğŸ¯ ç›®æ ‡åœ°å€: é€šè¿‡è´Ÿè½½å‡è¡¡(lb)è½¬å‘åˆ°åä¸º "userservice" çš„æœåŠ¡
		  
		            # --- æ–­è¨€: è¯·æ±‚å¿…é¡»æ»¡è¶³çš„æ¡ä»¶ (Predicates) ---
		            predicates:
		              - Path=/user/** #   æ–­è¨€æ¡ä»¶: å½“è¯·æ±‚è·¯å¾„åŒ¹é… /user/** æ¨¡å¼æ—¶ï¼Œæ­¤è·¯ç”±ç”Ÿæ•ˆ
		  
		            # --- è¿‡æ»¤å™¨: è¯·æ±‚åœ¨è½¬å‘å‰åç»è¿‡çš„å¤„ç† (Filters) ---
		            filters:
		              # è¿‡æ»¤å™¨ 1: å‰¥ç¦»è·¯å¾„å‰ç¼€ (StripPrefix)
		              # ä½œç”¨:   ä»è¯·æ±‚è·¯å¾„ä¸­ç§»é™¤æŒ‡å®šæ•°é‡çš„å‰ç¼€ã€‚è®¾ç½®ä¸º1ï¼Œæ„å‘³ç€ä¼šç§»é™¤è·¯å¾„çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ã€‚
		              # ç¤ºä¾‹:   å®¢æˆ·ç«¯è¯·æ±‚ /user/profile/1 -> ç½‘å…³å¤„ç†å -> è½¬å‘ç»™ userservice çš„è·¯å¾„å°†å˜ä¸º /profile/1
		              # åœºæ™¯:   è¿™æ˜¯æœ€å¸¸ç”¨çš„è¿‡æ»¤å™¨ä¹‹ä¸€ï¼Œç”¨äºéšè—æœåŠ¡åœ¨ç½‘å…³å±‚çš„è·¯å¾„å‰ç¼€ï¼Œè®©åç«¯æœåŠ¡ä¸“æ³¨äºè‡ªèº«ä¸šåŠ¡è·¯å¾„ã€‚
		              - StripPrefix=1
		  
		              # è¿‡æ»¤å™¨ 2: æ·»åŠ è¯·æ±‚å¤´ (AddRequestHeader)
		              # ä½œç”¨:   å‘è½¬å‘ç»™åç«¯æœåŠ¡çš„è¯·æ±‚ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„è¯·æ±‚å¤´ã€‚
		              # æ ¼å¼:   AddRequestHeader=HeaderName, HeaderValue
		              # ç¤ºä¾‹:   æ‰€æœ‰ç»æ­¤è·¯ç”±çš„è¯·æ±‚ï¼Œéƒ½ä¼šè¢«åŠ ä¸Š "X-Request-Source: gateway" çš„è¯·æ±‚å¤´ã€‚
		              # åœºæ™¯:   ç”¨äºæœåŠ¡é—´çš„æ¥æºè¯†åˆ«ã€ä¿¡æ¯è¿½è¸ªã€ä¼ é€’å…ƒæ•°æ®ç­‰ã€‚
		              - AddRequestHeader=X-Request-Source, gateway
		  
		          # è·¯ç”±è§„åˆ™ 2: è®¢å•æœåŠ¡ (ç¤ºä¾‹)
		          # -------------------------------------------------------------------
		          # - id: order_route
		          #   uri: lb://orderservice
		          #   predicates:
		          #     - Path=/order/**
		          #   filters:
		          #     - StripPrefix=1
		  ```
- è¿‡æ»¤å™¨
  heading:: true
	- **æ¦‚å¿µï¼š**
		- åœ¨è¯·æ±‚çœŸæ­£è¢«åç«¯æœåŠ¡å¤„ç†ä¹‹å‰ï¼Œæˆ–è€…å¤„ç†å®Œæˆä¹‹åï¼Œæ‹¦ä¸‹æ¥åšä¸€äº›é¢å¤–çš„äº‹æƒ…ï¼Œæ¯”å¦‚æ£€æŸ¥æƒé™ã€è®°å½•æ—¥å¿—ã€ä¿®æ”¹è¯·æ±‚å†…å®¹ï¼Œæˆ–è€…ç»™å“åº”åŠ ç‚¹ä¿¡æ¯ã€‚
		- å½“ä¸€ä¸ªè¯·æ±‚è¿›å…¥ç½‘å…³æ—¶ï¼Œä¼šä¾æ¬¡ç»è¿‡ç”±å¤šä¸ªè¿‡æ»¤å™¨ç»„æˆçš„æ£€æŸ¥æµæ°´çº¿ã€‚æ¯ä¸ªè¿‡æ»¤å™¨è´Ÿè´£æ‰§è¡Œä¸€é¡¹ç‰¹å®šçš„æ“ä½œï¼š
			- æœ‰çš„è´Ÿè´£èº«ä»½éªŒè¯ï¼ˆè®¤è¯è¿‡æ»¤å™¨ï¼‰
			- æœ‰çš„è®°å½•è¯·æ±‚ä¿¡æ¯ï¼ˆæ—¥å¿—è¿‡æ»¤å™¨ï¼‰
			- æœ‰çš„ä¸ºè¯·æ±‚æ·»åŠ æ ‡è¯†ï¼ˆæ·»åŠ è¯·æ±‚å¤´çš„è¿‡æ»¤å™¨ï¼‰
		- åªæœ‰é€šè¿‡æ‰€æœ‰æ£€æŸ¥çš„è¯·æ±‚ï¼Œæ‰èƒ½è¢«è½¬å‘åˆ°åç«¯çš„å¾®æœåŠ¡è¿›è¡Œå¤„ç†ã€‚
		  id:: 6852c79f-8360-477e-81a5-81510ed72277
	- **ä¸¤å¤§ç±»å‹çš„è¿‡æ»¤å™¨ï¼š**
		- **è·¯ç”±è¿‡æ»¤å™¨ï¼š**
			- **ä½œç”¨èŒƒå›´ï¼š**åªå¯¹æŸä¸€æ¡ç‰¹å®šçš„è·¯ç”±è§„åˆ™ç”Ÿæ•ˆã€‚
			- **é…ç½®æ–¹å¼ï¼š**åœ¨ `application.yml` æ–‡ä»¶ä¸­ï¼Œå†™åœ¨å…·ä½“è·¯ç”±çš„ `filters` èŠ‚ç‚¹ä¸‹ã€‚
		- **å…¨å±€è¿‡æ»¤å™¨ï¼š**
			- **ä½œç”¨èŒƒå›´ï¼š**å¯¹æ‰€æœ‰çš„è·¯ç”±è§„åˆ™éƒ½ç”Ÿæ•ˆã€‚
			- **é…ç½®æ–¹å¼ï¼š**é€šè¿‡ç¼–å†™ Java ä»£ç å®ç° `GlobalFilter` æ¥å£ï¼Œå¹¶æ³¨å†Œä¸ºä¸€ä¸ª Spring Beanã€‚
	- **ç¤ºä¾‹ï¼šç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„å…¨å±€è®¤è¯è¿‡æ»¤å™¨**
		- **ç›®æ ‡ï¼š**æ£€æŸ¥æ‰€æœ‰è¯·æ±‚çš„è¯·æ±‚å¤´ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªåä¸º `Authorization` çš„ Headerï¼Œå¹¶ä¸”å…¶å€¼å¿…é¡»ä¸º `admin`ã€‚å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œå°±æ‹¦æˆªè¯·æ±‚ï¼Œè¿”å› 401 æœªæˆæƒï¼›å¦‚æœé€šè¿‡ï¼Œåˆ™æ”¾è¡Œã€‚
		- ```java
		  package com.example.gateway.filters;
		  
		  import org.springframework.cloud.gateway.filter.GatewayFilterChain;
		  import org.springframework.cloud.gateway.filter.GlobalFilter;
		  import org.springframework.core.Ordered;
		  import org.springframework.http.HttpStatus;
		  import org.springframework.http.server.reactive.ServerHttpRequest;
		  import org.springframework.http.server.reactive.ServerHttpResponse;
		  import org.springframework.stereotype.Component;
		  import org.springframework.web.server.ServerWebExchange;
		  import reactor.core.publisher.Mono;
		  
		  @Component // å…³é”®ï¼šå°†è¿™ä¸ªè¿‡æ»¤å™¨æ³¨å†Œä¸º Spring çš„ä¸€ä¸ªç»„ä»¶ (Bean)ï¼Œä¸åŠ è¿™ä¸ªæ³¨è§£ï¼Œè¿‡æ»¤å™¨ä¸ä¼šç”Ÿæ•ˆã€‚
		  public class AuthGlobalFilter implements GlobalFilter, Ordered {
		  
		      /**
		       * æ ¸å¿ƒçš„è¿‡æ»¤é€»è¾‘å°±åœ¨è¿™é‡Œ
		       * @param exchange åŒ…å«äº†è¯·æ±‚å’Œå“åº”çš„ä¸Šä¸‹æ–‡ï¼Œä½ å¯ä»¥ä»å®ƒè¿™é‡Œæ‹¿åˆ° request å’Œ responseã€‚
		       * @param chain è¿‡æ»¤å™¨é“¾ï¼Œç”¨äºå°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨
		       * @return Mono<Void> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå“åº”å¼çš„å¼‚æ­¥å¤„ç†
		       */
		      @Override
		      public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
		          // 1. è·å–è¯·æ±‚å¯¹è±¡
		          ServerHttpRequest request = exchange.getRequest();
		          // 2. è·å–å“åº”å¯¹è±¡
		          ServerHttpResponse response = exchange.getResponse();
		  
		          // 3. ä»è¯·æ±‚å¤´ä¸­è·å– 'Authorization' çš„å€¼
		          String token = request.getHeaders().getFirst("Authorization");
		  
		          // 4. ç¼–å†™æˆ‘ä»¬çš„è®¤è¯é€»è¾‘
		          //    ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬è¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„é€»è¾‘ï¼štoken å¿…é¡»æ˜¯ "admin"
		          if (!"admin".equals(token)) {
		              // 5. è®¤è¯å¤±è´¥ï¼Œæ‹¦æˆªè¯·æ±‚
		              System.out.println(">> è®¤è¯å¤±è´¥ï¼Œè¯·æ±‚è¢«æ‹¦æˆªï¼");
		              // è®¾ç½®å“åº”çš„çŠ¶æ€ç ä¸º 401 UNAUTHORIZED (æœªæˆæƒ)
		              response.setStatusCode(HttpStatus.UNAUTHORIZED);
		              // ç»“æŸè¯·æ±‚å¤„ç†ï¼Œç›´æ¥è¿”å›å“åº”
		              return response.setComplete();
		          }
		  
		          // 6. è®¤è¯æˆåŠŸï¼Œæ”¾è¡Œè¯·æ±‚
		          //    è°ƒç”¨ chain.filter(exchange) å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè¯·æ±‚å°±ä¼šè¢«å‘å¾€åç«¯çš„å¾®æœåŠ¡ã€‚
		          System.out.println(">> è®¤è¯æˆåŠŸï¼Œè¯·æ±‚è¢«æ”¾è¡Œï¼");
		          return chain.filter(exchange);
		      }
		  
		      /**
		       * æŒ‡å®šè¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåº
		       * @return è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜
		       */
		      @Override
		      public int getOrder() {
		          return -1; // æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè®¤è¯è¿‡æ»¤å™¨åœ¨æ‰€æœ‰è¿‡æ»¤å™¨ä¸­æ‹¥æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥ç»™ä¸€ä¸ªè´Ÿæ•°å€¼
		      }
		  }
		  ```
-