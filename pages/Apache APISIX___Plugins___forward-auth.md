- **forward-auth 插件有什么用？**
	- **想象这样一个场景：**
		- 用户（客户端）想访问你的后端服务（Upstream）。当请求经过 APISIX 时，`forward-auth` 插件会先“拦住”这个请求。
		- 接着，它会拿着用户的“凭证”（例如请求头中的 `Authorization` 字段），去询问一个专门负责认证的“认证服务”：“这个请求能进吗？”
			- 如果认证服务返回 `2xx` 状态码，表示认证通过，`forward-auth` 插件就会放行，让请求继续转发到真正的后端服务。
			- 如果返回非 `2xx` 状态码，表示认证失败，`forward-auth` 就会直接拒绝请求（如返回 `401` 或 `403` 错误），或者让用户“先去办个证”（例如重定向到登录页面）。
		- 业务服务不再需要处理复杂的认证逻辑，只需专注于自身功能；而所有的认证与授权逻辑，都集中在独立的认证服务中。
- **forward-auth 插件的工作流程**
	- 当一个请求到达配置了 `forward-auth` 插件的路由时，会依次发生以下步骤：
		- **请求拦截：**APISIX 暂停将请求转发到上游服务（Upstream）。
		- **构造认证请求：**APISIX 向插件中配置的 `uri`（认证服务的地址）发起一个新的 HTTP 请求。
			- APISIX 会自动将原始客户端请求中的关键信息（如 Host、URI、HTTP Method、Scheme、Source IP）转换为一组 `X-Forwarded-*` 请求头，让认证服务能够了解原始请求的具体细节。
			- 同时，它还会包含在 `request_headers` 中指定的原始请求头（例如 Authorization、Cookie）。
		- **认证服务处理：**认证服务接收到请求后，根据内部逻辑对凭证进行验证。
		- **APISIX 判断响应：**APISIX 接收认证服务的返回结果，并根据状态码决定后续操作。
			- **如果响应状态码是 `2xx`，表示认证成功：**
				- APISIX 会恢复原始请求，并将其转发给后端业务服务。
				- 如果配置了 `upstream_headers`，APISIX 会从认证服务的响应头中提取指定字段（例如 `X-User-ID`），并附加到原始请求上，再发送到后端服务。这通常用于向下游传递用户信息。
			- **如果响应状态码不是 `2xx`（例如 401、403），表示认证失败：**
				- APISIX 不会将请求转发到后端服务。
				- 它会立即中断请求，并向客户端返回错误响应。状态码默认为 403，可通过 `status_on_error` 配置修改。
				- 如果配置了 `client_headers`，APISIX 会从认证服务的响应头中提取指定字段（例如 Location），并附加到返回给客户端的响应中，这常用于认证失败后的页面重定向。
- **forward-auth 插件的配置**
	- `uri`：外部认证服务的地址。
	- `request_method`：发送给认证服务的 HTTP 方法，默认值为 `GET`，可设置为 `POST`。
	- `request_headers`：一个数组，指定需要从客户端原始请求中复制哪些请求头，并转发给认证服务。
	- `extra_headers`：从原始请求中提取非头部信息（例如 POST Body 里的某个字段），并将其作为新的请求头，发送给认证服务。
	- `upstream_headers`：一个数组，指定认证成功后，需要从认证服务响应中复制哪些请求头，并添加到发往后端业务服务的请求中。
	- `client_headers`：一个数组，指定认证失败后，需要从认证服务响应中复制哪些请求头，并返回给客户端。
	- `status_on_error`：当认证服务发生网络错误时，返回给客户端的 HTTP 状态码。
-