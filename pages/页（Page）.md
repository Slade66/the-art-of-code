- InnoDB 以页为基本单位存储数据，每页包含若干行记录。
- 默认情况下，一个页的大小是 16KB，不过该值可以通过 `innodb_page_size` 参数调整。
- 页是 InnoDB 中最小的 I/O 单位。由于磁盘 I/O 开销较大，即使只需访问一行数据，InnoDB 也会将包含该行的整个页加载到内存中；数据修改后写回磁盘时，同样以页为单位进行。这种设计可以有效减少磁盘 I/O 的次数。
- 页的结构
  heading:: true
	- 文件头（File Header）
	  heading:: true
		- **作用：**用于存储页的元信息。
		- **结构：**
			- **页号：**
				- 表示该页在所属表空间文件中的偏移位置，是页在表空间中的唯一标识。InnoDB 通过页号可以快速定位并访问对应的数据页。
			- **校验和：**
				- 在将数据页写入磁盘前，InnoDB 会对页内容计算 CRC32 校验和，并将结果写入该字段。读取页时，系统会重新计算校验值并进行比对，若不一致，说明该页可能已损坏。
			- **指向上一页和下一页的指针：**
				- 将多个页串联成双向链表，有助于实现高效的范围扫描，避免频繁回溯树结构。
			- **页的类型：**
				- 标识该页的具体用途，如索引页、Undo 日志页等。
			- **日志序列号（Log Sequence Number, LSN）：**
				- 记录该页最后一次修改对应的日志序列号，用于判断该页是否已被持久化，也便于在数据库崩溃后，通过 redo 日志恢复数据。
	- 页头（Page Header）
	  id:: 68176c02-e0bb-4676-af42-9eaced0f6b43
	  heading:: true
		- ...
	- 最小记录（Infimum）和最大记录（Supremum）
	  heading:: true
		- 这两条特殊记录是页内记录链表的哨兵节点，分别作为链表的固定起点和终点。它们具有标准的记录头部，数据部分分别是字符串 `infimum` 和 `supremum`。
		- `Infimum` 的堆编号为 0，记录类型为 2；`Supremum` 的堆编号为 1，记录类型为 3。用户记录从堆编号 2 开始。
		- `Infimum` 记录始终指向第一个用户记录；最后一个用户记录则指向 `Supremum`，而 `Supremum` 的 `next_record` 指针指向 `NULL`。当页面内没有任何用户记录，此时 `Infimum` 的 `next_record` 会直接指向 `Supremum`。
	- 用户记录（User Records）
	  heading:: true
		- 在 InnoDB 存储引擎中，用户表中的每一行数据在内部被称为“记录”（Record），“用户记录”区域即用于存放这些实际插入的表数据。
		- 所有记录通过记录头中的“下一条记录指针”串联，组成一个单向链表。该链表以特殊的最小记录 `Infimum` 为起点，以最大记录 `Supremum` 为终点。
		- [[行（Row）]]
	- 空闲空间（Free Space）
	  heading:: true
		- 这部分空间用于存储新插入的用户记录。
	- 页目录（Page Directory）
	  heading:: true
		- **作用：**
			- 一个数据页（默认大小为 16KB）通常包含几十到上百条记录，这些记录通过记录头中的 `next_record` 指针，按照主键顺序组成一个单向链表。
			- 在查找某条记录时，最直接的方式是从链表起点（即 `Infimum` 之后的第一条用户记录）开始，沿 `next_record` 指针逐条遍历，直到找到目标记录或确认其不存在。然而，当记录数量较多时，这种线性查找效率较低。
			- 为提高页内查找效率，InnoDB 引入了页目录机制，通过支持二分查找，避免了全表遍历的低效方式，大幅提升了查询性能。
		- **原理：**
			- InnoDB 会将页内的记录（包括 `Infimum` 和 `Supremum` 两条虚拟记录）划分为若干个记录组。
				- 第一个组仅包含 `Infimum`，因此第一个槽固定指向 `Infimum`。
				- 最后一个组包含 `Supremum` 及其前的几条用户记录，最后一个槽固定指向 `Supremum`。
				- 中间的各组由最多 8 条用户记录组成，InnoDB 会尽量保持各组记录数量均衡。当某组记录数超过 8 条时，系统会自动将其拆分，形成新的组。
			- 每组最后一条记录的地址会按主键从小到大的顺序，依次存入一个指针数组中。这个数组中的每个元素称为一个“槽”，代表一个记录组的末尾记录地址，整个数组就构成了页目录。
			- 查找时，InnoDB 会先在页目录中进行二分查找，快速定位目标记录所在的记录组，然后只需在该组内沿 `next_record` 指针进行短距离顺序扫描，即可高效地查找到目标记录。
	- 文件尾（File Trailer）
	  heading:: true
		- **作用：**
			- **写入风险：**
				- 向磁盘写入数据页并非原子操作，过程中可能因断电、崩溃等故障而中断。如果写入未能完成，可能导致页头已更新而页尾仍是旧数据，造成页内容不一致。
			- **双重验证：**
				- 为防止上述情况，InnoDB 在读取页时执行双重校验：首先验证校验和是否一致，其次对比页头与页尾中 LSN 的低 4 字节是否匹配。只有两个校验都通过，系统才认为该页写入完整、数据未损坏，允许正常使用。
		- **结构：**
			- **校验和：**
				- 每次将页写入磁盘前，InnoDB 会基于页内容（不包括页头和页尾）计算 CRC32 校验和，并写入页尾。读取页时，系统重新计算校验和并与页尾中的值比对，若不一致，说明数据页可能在写入或读取过程中被破坏，系统将报错以防止使用损坏的数据。
			- **日志序列号的后 4 字节：**
				- 页尾存储的是该页最后一次修改时对应的 LSN 的低 4 个字节。InnoDB 在将页从磁盘读入内存时，会将页头中的完整 LSN 的低 4 字节与页尾存储的值进行比对，若不一致，通常说明该页在上次写入磁盘时未能完全写入，存在数据不完整的风险。