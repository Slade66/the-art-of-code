- **什么是 RBAC？**
	- RBAC（基于角色的访问控制）是一种通过“角色”来管理权限的方式。在不使用 RBAC 时，通常是直接为用户分配具体的权限；而采用 RBAC 后，先将权限赋予角色，再把角色分配给用户。
	- **多对多的关联关系：**可以将一个或多个角色分配给同一个用户，一个用户也可以同时拥有多个角色。同样地，可以将一个或多个权限分配给一个角色，而一个角色也可以包含多个权限。
	- **举例：**
		- 想象一下在一家公司中，你不会直接给员工张三分配“批准报销”、“编辑文档”、“发布公告”等零散的权限。相反，你会为他指定一个角色，例如“财务经理”。
		- 这个“财务经理”角色本身已经被授予了一系列完成其工作所需的权限，比如“批准一万元以下的报销”、“查看财务报表”等。
		- 当新员工李四入职并担任相同的岗位时，你无需再次为他逐项设置权限，这太繁琐了。只需为他分配“财务经理”这个角色，他就会自动获得该角色所包含的所有权限。
		- 这正是 RBAC 的核心思想：不直接将权限授予用户，而是将权限授予角色，再将角色分配给用户。
- **RBAC 的组成要素**
	- **用户（User）：**发出操作请求的主体。
	- **角色（Role）：**权限的集合。角色是根据组织内的职责和工作需要来创建的。例如：“文章编辑”、“财务审计”、“系统管理员”。
	- **权限（Permission）：**定义了一个具体的操作。它通常由两部分组成：操作和资源。
		- **资源（Resource）：**要操作的对象（某个 API 接口）。
		- **操作（Operation）：**可以对资源执行的动作，例如创建、读取、更新和删除。
- **RBAC 的验证流程**
	- **用户登录：**用户登录成功，后端生成 JWT Token，Token 里包含 `user_id`。
	  logseq.order-list-type:: number
	- **用户请求：**用户发起请求 `POST /api/v1/users`，携带 Token。
	  logseq.order-list-type:: number
	- **获取权限：**后端解析 Token 后获取用户信息，通过查询数据库或缓存确定该用户所属角色，再依据角色关联获取其对应的全部权限的集合。
	  logseq.order-list-type:: number
	- **授权：**系统检查用户请求的“操作 + 资源”是否包含在权限集合中。
	  logseq.order-list-type:: number
		- **如果包含：**授权通过，允许操作。
		- **如果不包含：**授权失败，拒绝操作（例如返回 403 Forbidden）。
- **为什么使用 RBAC？**
	- **简化管理：**
		- 当组织规模扩大、用户和权限数量急剧增加时，RBAC 通过引入“角色”这一中间层，大大简化了用户与权限之间的关系。你只需维护“用户-角色”和“角色-权限”的映射，而无需直接管理成千上万个“用户-权限”的直接映射。
		- 当系统新增功能（即新的权限）时，只需将该权限添加到相应角色中，所有拥有该角色的用户都会自动获得新权限。否则，你需要逐个为相关用户手动分配新权限，这不仅繁琐，而且容易出错。
		- 当新员工入职时，只需为其分配一个或多个已有角色即可，无需重复配置权限。否则，你必须重新为他配置每一个需要的权限，而不是简单地继承岗位已有的权限设置。
- **常见的问题与对策：**
	- **性能瓶颈：**
		- 不要每次 HTTP 请求都去查 5 张数据库表！一定要用 Redis。当角色权限发生变更时，清除缓存；鉴权时优先读缓存。
	- **超级管理员：**
		- 在代码里留一个“后门”逻辑：如果角色是 `superadmin`，直接跳过权限检查。避免配置错了把自己锁在外面。
-