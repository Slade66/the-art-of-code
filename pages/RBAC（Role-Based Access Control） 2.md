-
- #### 定义基本元素
	- **用户 (User)**: 操作者，即登录前端页面的用户。
	- **角色 (Role)**: 权限的集合，例如“项目A管理员”、“项目B开发者”、“超级管理员”。
	- **权限 (Permission)**: 一个具体的操作许可。建议使用 `资源:操作:对象` 的格式。
		- `route:create:project_A` (允许为项目A创建路由)
		- `route:list:project_A` (允许查看项目A的路由列表)
		- `route:delete:project_B` (允许删除项目B的路由)
		- `route:*:*` (允许对所有项目的所有路由进行任何操作 - 超级管理员权限)
- #### 数据库表设计 (Data Model)
	- 你需要几张表来支撑这个模型：
		- `users`: 用户表
		- `roles`: 角色表 (id, role_name)
		- `permissions`: 权限表 (id, permission_string)
		- `user_roles`: 用户和角色的关联表 (user_id, role_id)
		- `role_permissions`: 角色和权限的关联表 (role_id, permission_id)
- **Kratos 中的实现逻辑 (Implementation in Kratos)**
	- **流程图**:
		- `Frontend Request` -> `Kratos HTTP Server` -> `JWT Auth Middleware` -> `Authorization Middleware` -> `Service/Biz Logic` -> `APISIX Admin API`
	- **认证中间件 (Authentication Middleware)**:
		- 这是标准操作。使用 JWT 中间件验证请求头中的 Token。
		- 验证通过后，解析出 `userID`，并将其存入 `context.Context` 中，供后续流程使用。
	- **授权中间件 (Authorization Middleware)**:
		- 从 `context` 中获取 `userID`。
		- 根据当前请求的 `HTTP Method` 和 `Path`，确定**需要的权限**。例如，`POST /managed-routes` 就需要 `route:create` 权限。
		- 从请求体或路径参数中获取**操作对象**的信息。例如，创建路由时，从 JSON Body 中获取 `projectId`。
		- 结合起来，得到本次操作所需的具体权限，例如 `route:create:project_A`。
		- **查询数据库**: 检查该 `userID` 是否拥有 `route:create:project_A` 这个权限（通过其角色进行关联查询）。
		- **决策**:
			- 如果有权限，则调用 `handler.Next()` 继续执行。
			- 如果没有权限，则直接返回 `403 Forbidden` 错误。
	- **Service/Biz 业务逻辑层**:
		- **数据转换**: 将前端传来的简化版 JSON (`ManagedRoute`) 转换为 APISIX Admin API 需要的完整格式。
		- **安全增强**: 在这里可以强制添加一些安全策略。比如，用户为 `project_A` 创建路由，你的后端可以强制要求其上游 (upstream) 地址必须是 `*.project-a.svc.cluster.local` 这个域名下的，防止用户将流量转发到其他不相关的服务。
		- **发起请求**: 使用 Go 的 `http.Client`，带上你在配置中存储的 `X-API-KEY` (APISIX Admin API Key)，向 APISIX Admin API 发送请求。
		- **结果处理**: 处理 APISIX 的返回结果。如果成功，可能需要将 APISIX 返回的 `route_id` 和你自己的 `route_id` 存入数据库。然后将结果包装成前端需要的格式返回。
-